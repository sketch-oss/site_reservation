/* =========================
   Design System — Salle de visite LAP
   ========================= */

/* ---------- Thème & variables ---------- */
:root{
  --radius:14px;
  --shadow:0 8px 24px rgba(16,24,40,.06);
  --ring:0 0 0 3px rgba(57,90,162,.20);

  --accent:#395AA2;
  --bg:#EFEADC;
  --panel:#ffffff;
  --muted:#C2DFF2;
  --border: color-mix(in oklab, #395AA2 20%, #FFFFFF);
  --text:#0f172a;
  --text-muted: color-mix(in oklab, #395AA2 45%, #0f172a);
  --chip:#f7fafd;

  --lap-tint: color-mix(in oklab, var(--panel) 92%, var(--accent));
  --lap-border: color-mix(in oklab, var(--accent) 30%, var(--border));

  --ok:#16a34a; --no:#dc2626; --warn:#f59e0b;
}

/* Palette LAP (clair) via <html class="palette-lap light"> */
:root.palette-lap.light{
  --accent:#395AA2;
  --bg:#EFEADC;
  --panel:#ffffff;
  --muted:#C2DFF2;
  --border: color-mix(in oklab, #395AA2 20%, #FFFFFF);
  --text:#0f172a;
  --text-muted: color-mix(in oklab, #395AA2 45%, #0f172a);
  --chip:#f7fafd;
}

/* ---------- Typos ---------- */
@font-face{
  font-family:"AdelphiPEVar";
  src: local("Adelphi PE Variable"), local("Adelphi PE Variable Black");
  font-weight: 900; font-style: normal; font-display: swap;
}
@font-face{
  font-family:"AcuminPro";
  src: local("Acumin Pro"), local("AcuminPro-Regular");
  font-weight: 400; font-style: normal; font-display: swap;
}

/* ---------- Reset doux ---------- */
*{ box-sizing:border-box }
html,body{ height:100% }
html,body{ background:var(--bg); color:var(--text); }
body{
  margin:0;
  font:14px/1.45 AcuminPro, "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  transition: background .3s, color .3s;
}
h1{ margin:0 0 12px; font-size:clamp(1.35rem, 2.2vw, 1.9rem); }
h2{ margin:0 0 10px; font-size:1.1rem }
h1, h2, .pill-svc{ font-family: AdelphiPEVar, AcuminPro, "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-weight:900; }
a{ color:inherit }
.hidden{ display:none !important }
.sub,.note{ font-size:.92rem; color:var(--text-muted) }

/* Focus */
:where(input,button,select,textarea):focus{ outline:none; box-shadow:var(--ring) }

/* ---------- Layout / header ---------- */
.app{
  width:min(1600px,96vw);
  margin:20px auto;
  padding-inline: clamp(10px,2vw,24px);
}
.controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:12px }
.split{ display:flex; gap:8px; align-items:center }

.brand-header{ display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:12px; margin-bottom:16px }
.brand-logos{ display:flex; align-items:center; gap:16px }
.brand-logos .logo{ height: clamp(40px,5vw,60px); width:auto; object-fit:contain; filter: drop-shadow(0 2px 4px rgba(0,0,0,.1)) }
.brand-logos .lap{ max-height:60px }
.brand-logos .cpn{ max-height:45px; opacity:.9 }
@media (max-width:640px){
  .brand-header{ flex-direction:column; align-items:center; text-align:center }
  .brand-logos{ justify-content:center }
  .brand-logos .logo{ height: clamp(36px,8vw,50px) }
}

/* ---------- Formes & boutons ---------- */
input,button,select,textarea{
  padding:10px 12px; border-radius:10px; border:1px solid var(--border);
  background:var(--panel); color:var(--text); transition:background .2s,border-color .2s,box-shadow .2s;
}
button{ cursor:pointer } button:hover{ background:var(--muted) }

.btn{ background:var(--accent); color:#fff; border:1px solid color-mix(in oklab, var(--accent) 75%, #0000) }
.btn:hover{ filter:brightness(1.05) }
.btn-ghost{ background:transparent; border:1px solid transparent; color:var(--text-muted) }
.btn-danger{ border-color:#fecaca; color:#991b1b; background:#fff5f5 }

.pill{ padding:6px 12px; border:1px solid var(--border); border-radius:999px; background:var(--panel); color:var(--text-muted) }

/* ---------- Cartes ---------- */
section,.card,.day-card{
  background:var(--panel); border:1px solid var(--border); border-radius:var(--radius);
  box-shadow:var(--shadow); padding:14px;
}
.two-cols{ display:grid; grid-template-columns:repeat(2,1fr); gap:18px }
.day-col h2{ margin:0 0 4px; font-size:1.15rem; text-transform:capitalize; color:var(--accent) }

/* ---------- Tabs ---------- */
.tabs{ display:flex; gap:8px; margin:8px 0 16px }
.tab{ padding:8px 12px; border:1px solid var(--border); border-radius:10px; background:var(--panel) }
.tab.active{ background:var(--muted) }
.tab[disabled], .tab[aria-disabled="true"]{ opacity:.45; cursor:not-allowed; pointer-events:none }

/* ---------- Toasts ---------- */
.toasts{ position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999 }
.toast{
  min-width:240px; max-width:360px; padding:10px 12px; border-radius:12px;
  border:1px solid var(--border); background:var(--panel); box-shadow:var(--shadow);
  transition: transform .2s, opacity .2s;
}
.toast.ok{ border-color:#c7efd4 }
.toast.warn{ border-color:#ffe3b0 }
.toast.err{ border-color:#ffd1d1 }
.toast .title{ font-weight:700; margin-bottom:4px }
.toast .msg{ font-size:.9rem; color:var(--text-muted) }

/* ---------- Table générique ---------- */
.table-wrap{ overflow-x:auto; border-radius:12px; border:1px solid var(--border); background:var(--panel); box-shadow:var(--shadow) }
table{ width:100%; border-collapse:separate; border-spacing:0 }
thead th{ position:sticky; top:0; background:var(--muted); border-bottom:1px solid var(--border); text-align:left; padding:12px }
tbody td, tbody th{ border-bottom:1px solid var(--border); padding:10px; vertical-align:top }
tbody th{ background:var(--muted); font-weight:700; width:140px }
td.muted{ background:color-mix(in oklab,var(--panel) 85%,var(--muted)); color:var(--text-muted) }

/* ---------- Badges compacts ---------- */
.badge{
  display:inline-flex; align-items:center; justify-content:center;
  height:22px; padding:0 10px; border-radius:9999px; font-size:.85rem; font-weight:500; line-height:1;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
}
.badge.ok{ background:#2a7b63; color:#d6f6ec }
.badge.full{ background:#803b3b; color:#ffeaea }

/* Actions (ligne badge + bouton) */
.actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; margin-top:8px }
.actions button{ margin:0; padding:4px 10px; height:26px; line-height:1; display:inline-flex; align-items:center; justify-content:center; border-radius:6px; font-size:.85rem }

/* ---------- Chips & noms ---------- */
.names{ margin-top:8px; display:flex; gap:8px; flex-wrap:wrap }
.chip{ background:var(--chip); border:1px dashed var(--border); border-radius:999px; padding:4px 10px; font-size:.85rem }
.chip.locked{ opacity:.55 }

/* ---------- Modale ---------- */
.modal{ position:fixed; inset:0; background:rgba(0,0,0,.35); display:flex; align-items:center; justify-content:center; z-index:10000 }
.modal-card{ width:min(480px,92vw); background:var(--panel); border:1px solid var(--border); border-radius:16px; box-shadow:var(--shadow); padding:16px }
.modal.hidden{ display:none }
.input-suffix{ position:relative; display:inline-flex; align-items:center }
.input-suffix input{ padding-right:140px }
.input-suffix span{ position:absolute; right:12px; color:var(--text-muted); pointer-events:none; font-size:.95em }

/* ========================
   Composant PILL (créneau)
   ======================== */
.pill-btn{
  position:relative;
  display:grid;
  grid-template-columns:minmax(0,1fr) auto;
  grid-template-areas:"svc badge" "time badge";
  gap:2px 10px;
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background: linear-gradient(180deg,var(--panel), color-mix(in oklab, var(--panel) 85%, var(--muted)));
  box-shadow: 0 1px 0 rgba(0,0,0,.04), inset 0 0 0 1px rgba(0,0,0,.06);
  transition: transform .06s ease, box-shadow .12s ease, opacity .2s ease, border-color .12s ease;
  min-width:0;
}
.pill-btn:hover{ transform: translateY(-1px); box-shadow: 0 6px 18px rgba(16,24,40,.12) }
.pill-btn:disabled{ opacity:.6; cursor:not-allowed }
.pill-btn::before{ content:none } /* pas de ruban gauche */

.pill-svc{ grid-area:svc; font-weight:700; letter-spacing:.2px; min-width:0; overflow:hidden; text-overflow:ellipsis }
.pill-time{ grid-area:time; opacity:.85; font-variant-numeric: tabular-nums; min-width:0; overflow:hidden; text-overflow:ellipsis }
.pill-badge{
  grid-area:badge; justify-self:end; font-size:.82rem; line-height:1;
  padding:6px 10px; border-radius:999px; border:1px solid transparent;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}

/* États */
.pill-ok{ border-color: color-mix(in oklab, var(--accent) 35%, var(--border)); background: color-mix(in oklab, var(--ok) 10%, var(--panel)) }
.pill-ok .pill-badge{ background:#eafff2; border-color:#c7efd4; color:#0a5e2a }
.pill-full{ background: color-mix(in oklab, #ff3b30 10%, var(--panel)); border-color: color-mix(in oklab, #ff3b30 35%, var(--border)) }
.pill-full .pill-badge{ background:#ffe8e8; border-color:#ffd1d1; color:#a11212 }
.pill-past{ background: color-mix(in oklab, var(--panel) 85%, var(--muted)); opacity:.75 }
.pill-past .pill-badge{ background:#eceff3; border-color:#dde3ea; color:#6b7280 }

/* ========================
   Vue SEMAINE (table)
   ======================== */
#grid{ overflow-x:auto; -webkit-overflow-scrolling:touch }
.week-table{
  width:100%;
  min-width:1100px;
  border-collapse:separate; border-spacing:0; table-layout:fixed;
  background:var(--panel); border:1px solid var(--border);
  border-radius:12px; overflow:hidden; box-shadow:var(--shadow);
}
.week-table td, .week-table th{
  border:1px solid color-mix(in oklab, var(--border) 70%, #fff);
  overflow:hidden; vertical-align:top;
}
.week-table thead th{
  position:sticky; top:0; z-index:4;
  background:var(--panel); color:var(--text);
  padding:10px; text-align:center; font-weight:700;
}
.week-table thead th:first-child{ z-index:6 } /* coin */
.week-table tbody th{
  position:sticky; left:0; z-index:5;
  width:86px; min-width:86px; text-align:right;
  background:var(--panel); font-variant-numeric: tabular-nums; padding:10px;
}
.week-table tbody tr:nth-child(even) td,
.week-table tbody tr:nth-child(even) th{
  background: color-mix(in oklab, var(--panel) 96%, var(--border));
}
.week-table td{ padding:8px }
.week-table .pill-btn{ width:100%; margin:0 }

/* En semaine : on n’affiche que l’heure + badge */
.view-week .week-table .pill-svc{ display:none }
.view-week .week-table .pill-btn{
  grid-template-columns: max-content 1fr;
  grid-template-areas: "time badge";
}
.view-week .week-table .pill-time{ font-weight:700; white-space:nowrap }
.view-week .week-table .pill-badge{ max-width:56% }

/* ========================
   Vue JOUR (table)
   ======================== */
#view-day .table-wrap{ overflow-x:auto; -webkit-overflow-scrolling:touch }
.day-table{
  width:100%; border-collapse:collapse; table-layout:fixed; background:var(--panel);
  border:1px solid var(--border); border-radius:12px; overflow:hidden; box-shadow:var(--shadow);
}
.day-table thead th{ position:sticky; top:0; background:var(--muted); border:1px solid var(--border); padding:12px; text-align:left }
.day-table tbody th, .day-table tbody td{ border:1px solid var(--border); padding:8px; vertical-align:top }
#view-day td{ text-align:center }
#view-day .actions{ justify-content:center; margin-top:0 }
#view-day .col-grey{ background:var(--panel); border:1px dashed var(--border); border-radius:6px; padding:6px 8px; color:var(--text-muted) }

/* Même pill qu’en semaine : time + badge uniquement */
.day-table .pill-svc{ display:none }
.day-table .pill-btn{ grid-template-areas:"time badge"; grid-template-columns:1fr auto }

/* ========================
   Section CONFIG
   ======================== */
.card-grid{ display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)) }
.row{ display:grid; gap:12px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)) }
.service{
  display:grid; grid-template-columns: minmax(280px,1fr) 40px 130px 130px 120px; gap:12px; align-items:center;
}
.service > button[data-del]{ width:28px; height:28px; display:flex; align-items:center; justify-content:center; line-height:1; justify-self:center }
.service input[type="number"], .service select{ width:100% }
.tag{ display:inline-block; padding:3px 8px; border:1px solid var(--border); border-radius:999px; background:color-mix(in oklab,var(--panel) 85%, var(--accent)) }
.day-card{ border:1px dashed var(--border); border-radius:12px; padding:12px }
.day-title{ font-weight:700; color:var(--accent); margin:0 0 8px }
.save{ padding:10px 14px }

.cfg-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:16px }
.cfg-day{
  display:grid; gap:10px;
  grid-template-rows: auto min-content minmax(110px,1fr) min-content minmax(110px,1fr) min-content minmax(110px,1fr) min-content minmax(110px,1fr);
  background:var(--panel); border:1px solid var(--border); border-radius:10px; padding:12px;
}
.cfg-day h3{ margin:0 0 4px; font-size:1rem; font-weight:700 }
.cfg-title{ display:flex; align-items:center; font-weight:600; line-height:1.2; word-break:break-word; hyphens:auto }
.cfg-area{ width:100%; min-height:110px; padding:8px 10px; resize:vertical; border-radius:8px }
.cfg-area.gray{ background:transparent; color:var(--text-muted); border:1px dashed var(--border) }
.badge-mute{ display:inline-block; font-size:.8em; padding:2px 6px; border-radius:999px; background:var(--panel); border:1px solid var(--border); color:var(--text-muted); margin-left:6px }
#configPage .day-card.closed{ display:none }

/* Services (liste) */
#servicesSec .services-head{ display:grid; grid-template-columns: minmax(260px,1fr) 110px 130px 180px 42px; gap:10px 12px; font-weight:600; margin:6px 0; color:var(--text-muted) }
#servicesList .service{ display:grid; grid-template-columns: minmax(260px,1fr) 110px 130px 180px 42px; gap:12px; align-items:center }
#servicesList .service .svc-label{ display:flex; flex-direction:column; line-height:1.2 }
#servicesList .service .svc-label small{ color:var(--text-muted) }
#servicesList .service input[type="number"], #servicesList .service select{ width:100%; height:36px; padding:6px 8px }
#servicesList .service > button[data-del]{ width:36px; height:36px; border-radius:10px; display:flex; align-items:center; justify-content:center; justify-self:center }
#servicesList .service > button[data-del]:hover{ transform:translateY(-1px) }
#servicesSec .svc-add{ display:grid; grid-template-columns:1fr 110px 130px 180px 42px; gap:10px 12px; align-items:center; margin-top:10px }
#servicesSec .svc-add input, #servicesSec .svc-add select, #servicesSec .svc-add button{ height:36px; width:100% }

@media (max-width:900px){
  #servicesSec .services-head{ grid-template-columns:minmax(200px,1fr) 90px 110px 1fr 42px }
  #servicesList .service{ grid-template-columns:minmax(200px,1fr) 90px 110px 1fr 42px }
}
@media (max-width:680px){
  #servicesSec .services-head{ display:none }
  #servicesList .service{ grid-template-columns:1fr 1fr; gap:10px }
  #servicesList .service .svc-label{ grid-column:1 / -1 }
  #servicesList .service > button[data-del]{ grid-column:2; justify-self:end }
}

/* ---------- Divers ---------- */
.pill, .chip, .tag{ background:var(--chip); border:1px solid var(--border); border-radius:999px; padding:6px 10px; color:var(--text-muted) }
#view-day .actions{ justify-content:center }
#view-day .col-grey .note, #view-day td.muted .note{ display:inline-block; text-align:center }

/* ---------- Responsive densité ---------- */
@media (max-width:1280px){
  .week-table td{ padding:6px }
  .pill-btn{ padding:8px 10px }
  .pill-badge{ font-size:.78rem }
}
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important }
}
